<block-ui message="Loading...">
</block-ui>

<!-- <div class="pl-5">
    <a [routerLink]="['/tools']" class="d-flex align-items-center"><mat-icon class="mr-1 default-icon">keyboard_arrow_left</mat-icon><span>Tools</span></a>
</div> -->

<h3 class="mb-3 pl-5 mt-3" id="heading">
    {{ addItem ? 'Add Location' : 'Update Location' }}
</h3>
<!-- <mat-divider class="ml-5 mr-5"></mat-divider> -->
<div class="ml-5 mr-5">
    <app-alert [message]="message" [type]="type" id="alert">
    </app-alert>
</div>

<div class="pl-5 pr-5 pb-5">
    <form [formGroup]="locationForm">
        <div class="form-group row">
            <div class="col-xl-3">
                <div class="row">
                    <div class="col-xl-12 d-flex align-items-center ">
                        <app-image-upload></app-image-upload>
                    </div>
        
                    <!-- Phone  -->
                    <div class="col-xl-12 d-flex align-items-center">
                        <mat-form-field [appearance]="apperance" class="full-width">
                            <mat-label>Phone</mat-label>
                            <input matInput placeholder="Phone" type="tel" formControlName="phone">
                        </mat-form-field>
                    </div>
        
                    <!-- Mobile  -->
                    <div class="col-xl-12 d-flex align-items-center">
                        <mat-form-field [appearance]="apperance" class="full-width">
                            <mat-label>Mobile</mat-label>
                            <input matInput placeholder="Mobile" type="tel" formControlName="mobile">
                        </mat-form-field>
                    </div>
        
                    <!-- Email id  -->
                    <div class="col-xl-12 d-flex align-items-center">
                        <mat-form-field [appearance]="apperance" class="full-width">
                            <mat-label>Email id</mat-label>
                            <input matInput placeholder="Email id" required formControlName="emailId">
                            <mat-error *ngIf="locationForm.get('emailId').hasError('required')">
                                Email is required.
                            </mat-error>
                            <mat-error *ngIf="locationForm.get('emailId').hasError('pattern')">
                                Please enter a valid email address.
                            </mat-error>
                        </mat-form-field>
                    </div>
        
                    <!-- Website  -->
                    <div class="col-xl-12 d-flex align-items-center">
                        <mat-form-field [appearance]="apperance" class="full-width">
                            <mat-label>Website</mat-label>
                            <input matInput placeholder="Website" formControlName="website">
                            <mat-error *ngIf="locationForm.get('website').touched && locationForm.get('website').hasError('pattern')">
                                Please enter a valid website address.
                            </mat-error>
                        </mat-form-field>
                    </div>

                    <!-- Fax  -->
                    <div class="col-xl-12 d-flex align-items-center">
                        <mat-form-field [appearance]="apperance" class="full-width">
                            <mat-label>Fax</mat-label>
                            <input matInput placeholder="Fax" type="tel" formControlName="fax">
                        </mat-form-field>
                    </div>
                </div>
            </div>
            <div class="col-xl-6 bg-white">
                <div class="row mt-3 pb-2 pl-3 pr-3">
                    <!-- Location Name  -->
                    <div class="col-xl-12 text-right">
                        <span>Required</span>
                    </div>
                    <div class="col-xl-12 d-flex align-items-center">
                        
                        <mat-form-field [appearance]="apperance" class="full-width">
                            <!-- <mat-label>Location Name</mat-label> -->
                            <input matInput placeholder="Location Name" required formControlName="locationName">
                            <mat-error *ngIf="locationForm.get('locationName').hasError('required')">
                                Location Name is required.
                            </mat-error>
                            <mat-hint>Short Name of this Location</mat-hint>
                        </mat-form-field>
                    </div>
        
                    <!-- Location Registration Name  -->
                    <div class="col-xl-12 d-flex align-items-center">
                        <mat-form-field [appearance]="apperance" class="full-width">
                            <!-- <mat-label>Location Registration Name</mat-label> -->
                            <input matInput placeholder="Location Registration Name" formControlName="locationRegistrationName">
                        </mat-form-field>
                    </div>
        
                    <!-- Location Registration Number  -->
                    <div class="col-xl-12 d-flex align-items-center">
                        <mat-form-field [appearance]="apperance" class="full-width">
                            <!-- <mat-label>Location Registration Number</mat-label> -->
                            <input matInput placeholder="Location Registration Number" formControlName="locationRegistrationNo">
                        </mat-form-field>
                    </div>
        
                    <!-- Contact Person  -->
                    <div class="col-xl-12 d-flex align-items-center">
                        <mat-form-field [appearance]="apperance" class="full-width">
                            <!-- <mat-label>Contact Person</mat-label> -->
                            <input matInput placeholder="Contact Person" formControlName="contactPerson">
                            <mat-hint>Kavanii will contact this person for any information</mat-hint>
                        </mat-form-field>
                    </div>
                </div>

                <mat-accordion>
                    <mat-expansion-panel expanded="true">
                        <mat-expansion-panel-header>
                            <mat-panel-title>
                              Location Address
                            </mat-panel-title>
                            <mat-panel-description>
                              Required
                            </mat-panel-description>
                        </mat-expansion-panel-header>

                        <!-- Address details -->
                        <div class="row pt-2 pb-2">
                            
                            <div class="col-xl-12">
                                <mat-form-field [appearance]="apperance" class="full-width">
                                    <!-- <mat-label>Address 1</mat-label> -->
                                    <input matInput placeholder="Address 1" formControlName="address1">
                                </mat-form-field>
                            </div>
                            <div class="col-xl-12">
                                <mat-form-field [appearance]="apperance" class="full-width">
                                    <!-- <mat-label>Address 2</mat-label> -->
                                    <input matInput placeholder="Address 2" formControlName="address2">
                                </mat-form-field>
                            </div>
                            <div class="col-xl-12">
                                <mat-form-field [appearance]="apperance" class="full-width">
                                    <mat-label>City</mat-label>
                                    <mat-select formControlName="city">
                                        <mat-option value="Sydney">
                                            Sydney
                                        </mat-option>
                                        <mat-option value="Melbourne">
                                            Melbourne
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <div class="col-xl-6">
                                <mat-form-field [appearance]="apperance" class="full-width">
                                    <mat-label>State</mat-label>
                                    <mat-select formControlName="state">
                                        <mat-option value="ACT">
                                            ACT
                                        </mat-option>
                                        <mat-option value="NSW">
                                            NSW
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            
                            <div class="col-xl-6">
                                <mat-form-field [appearance]="apperance" class="full-width">
                                    <!-- <mat-label>Post code</mat-label> -->
                                    <input matInput placeholder="Post code" formControlName="postCode">
                                </mat-form-field>
                            </div>

                            <div class="col-xl-12">
                                <mat-form-field [appearance]="apperance" class="full-width">
                                    <mat-label>Country</mat-label>
                                    <mat-select formControlName="country">
                                        <mat-option *ngFor="let c of countries | orderBy: 'country_Name'" [value]="c.country_Name">
                                          {{ c.country_Name }}
                                        </mat-option>
                                      </mat-select>
                                </mat-form-field>
                            </div>
                        </div>
        
                    </mat-expansion-panel>
                </mat-accordion>

                <mat-accordion>
                    <mat-expansion-panel expanded="true">
                        <mat-expansion-panel-header>
                            <mat-panel-title>
                              Bank details
                            </mat-panel-title>
                            <mat-panel-description>
                              Required
                            </mat-panel-description>
                        </mat-expansion-panel-header>
                        <div class="row">
                            <!-- Bank Name  -->
                            <div class="col-xl-12 d-flex align-items-center">
                                <mat-form-field [appearance]="apperance" class="full-width">
                                    <!-- <mat-label>Bank Name</mat-label> -->
                                    <input matInput placeholder="Bank Name" formControlName="bankName">
                                </mat-form-field>
                            </div>
                            <!-- BSB Number  -->
                            <div class="col-xl-12 d-flex align-items-center">
                                <mat-form-field [appearance]="apperance" class="full-width">
                                    <!-- <mat-label>BSB Number</mat-label> -->
                                    <input matInput placeholder="BSB Number" formControlName="bsbNumber">
                                </mat-form-field>
                            </div>
        
                            <!-- Account Number  -->
                            <div class="col-xl-12 d-flex align-items-center">
                                <mat-form-field [appearance]="apperance" class="full-width">
                                    <!-- <mat-label>Account Number</mat-label> -->
                                    <input matInput placeholder="Account Number" formControlName="accountNumber">
                                </mat-form-field>
                            </div>
        
                            <!-- Invoice Terms  -->
                            <div class="col-xl-12 d-flex align-items-center">
                                <mat-form-field [appearance]="apperance" class="full-width">
                                    <!-- <mat-label>Invoice Terms</mat-label> -->
                                    <textarea matInput placeholder="Invoice Terms" formControlName="invoiceTerms" rows="3"></textarea>
                                </mat-form-field>
                            </div>
        
                            <!-- Notes  -->
                            <div class="col-xl-12 d-flex align-items-center">
                                <mat-form-field [appearance]="apperance" class="full-width">
                                    <!-- <mat-label>Notes</mat-label> -->
                                    <textarea matInput placeholder="Notes" formControlName="notes" rows="3"></textarea>
                                </mat-form-field>
                            </div>
                        </div>
                    </mat-expansion-panel>
                </mat-accordion>
                
            </div>
            <div class="col-xl-3">
                <div class="col-xl-12 text-right">
                    <!-- <mat-button-toggle-group #group="matButtonToggleGroup" formControlName="status">
                        <mat-button-toggle value="active" color="warn">
                            <mat-icon>check_circle_outline</mat-icon>
                            Active
                            </mat-button-toggle>
                            <mat-button-toggle value="inactive" color="warn">
                            Inactive
                        </mat-button-toggle>
                    </mat-button-toggle-group> -->
                    <kendo-switch formControlName="status"
                        [onLabel]="'Active'"
                        [offLabel]="'Inactive'"
                        class="mt-3 mb-3"
                    ></kendo-switch>
                    <mat-divider></mat-divider>
                </div>
                <div class="col-xl-12">
                    <h4 class="mt-3 mb-3 bold d-flex align-items-center d-inline-block">
                        <mat-icon>calendar_today</mat-icon>
                        Calendar Options
                        <div class="d-inline edit-icon" *ngIf="clickedCalendarOptions">
                            <a href="" (click)="openDialog($event);" class="align-self-center" style="text-decoration: none !important;">
                                <mat-icon class="d-inline" class="default-icon">edit</mat-icon>
                                <span>
                                    Edit
                                </span>
                            </a>
                        </div>
                    </h4>
                    <div *ngIf="!clickedCalendarOptions">
                        <button mat-stroked-button color="accent" class="ml-3 wide" (click)="openDialog($event);">Set up Calendar</button>
                    </div>
                </div>
                <div *ngIf="clickedCalendarOptions">
                    <div class="col-xl-12 mt-5">
                        <div class="d-flex align-items-center">
                            <span class="d-inline-block color mr-3" [ngStyle]="{ 'background-color' : locationForm.get('calendarColor').value  }">
                            </span>
                            <span class="d-inline-block" style="max-width: 100px;">
                                {{ locationForm.get('startTime').value | date:'shortTime'  }} to {{ locationForm.get('endTime').value | date:'shortTime'  }}
                            </span>
                        </div>
                    </div>
                    <div class="col-xl-12 mt-3">
                        <h6>Timezone</h6>
                        {{ locationForm.get('timeZone').value  }}
                    </div>
                    <div class="col-xl-12 mt-3">
                        <h6>Time slot</h6>
                        {{ locationForm.get('timeSlot').value  }}
                    </div>
                    <div class="col-xl-12 mt-3">
                        <h6>Double Booking</h6>
                        {{ locationForm.get('isDoubleBooking').value == true ? "Allowed" : "Not Allowed" }}
                    </div>
                    <div class="col-xl-12 mt-3">
                        <h6>Patient online booking</h6>
                        {{ locationForm.get('isPatientOnlineBooking').value == true ? "Allowed" : "Not Allowed"  }}
                    </div>
                </div>
            </div>
        </div>
    </form>

    <!-- {{ locationForm.value | json}} -->
</div>



<div class="text-right control-row">
    <mat-divider class="ml-5 mr-5"></mat-divider>
    <div class="pt-3">
        <button mat-stroked-button color="accent" class="mr-3" (click)="cancel();">Cancel</button>
        <button mat-raised-button color="accent" class="mr-5 wide" (click)="createlocation();" [disabled]="locationForm.invalid || submitting">
            <span *ngIf="!submitting">Save</span>
            <span *ngIf="submitting">Saving...</span>
            <!-- <mat-spinner class="spinner" diameter="15" *ngIf="submitting"></mat-spinner> -->
        </button>
    </div>
</div>  